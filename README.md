# l2cr

A Lineage 2 (High Five) server emulator ported from [L2J](http://www.l2jserver.com) (written in Java) to Crystal.

# Requirements

In order for the game server to work it needs the following:
  - The Ruby login server
  - The Crystal source code that is shared with the login server
  - L2J's datapack and configuration (.properties files) folders
  - A properly set up MySQL database (as if to be used with L2J)
  - The geodata files (optional)

# TODO list

- [x] Connect to login server
  - [x] Can connect with Ruby's login server
  - [ ] Can connect with L2J's login server
- [x] Database
  - [x] Working
  - [x] Compatible with L2J's database
  - [x] Use transactions
  - [ ] Use batch
- [x] Character creation
  - [x] Valid name checking
  - [x] Valid appearance combination checking
  - [x] Starting equipment
  - [x] Starting shortcuts
- [x] Character deletion
  - [x] Delayed character deletion (with countdown)
- [x] Character progression
  - [x] Exp/sp/level gain
  - [x] Vitality
  - [ ] Nevit's Blessing
- [x] Items
  - [x] Special abilities
    - [x] Soul crystal quest
  - [x] Enchanting
  - [x] Augmentations
  - [x] Shadow items
  - [x] Equipment preview
  - [x] Elements (further testing needed)
  - [x] Crystallizing
  - [x] Crafting
  - [x] Armor set bonuses
  - [x] HP enchant bonuses
  - [x] Extractable items (items that contain other items)
- [x] Skills
  - [x] Skill enchanting
  - [x] Healer skill transfer
  - [x] Channelized skills (like Volcano)
  - [x] Buffs restored on login
- [x] Pets/Servitors
  - [x] Riding
  - [x] Pet feeding
  - [x] Pet skills (some levels are missing)
  - [ ] Evolving/exchanging pets
    - [x] Hatchling to Strider
    - [ ] All the others
  - [x] Servitor resummon on login
  - [ ] Pet resummon on login
- [x] Cubics
  - [ ] Storm cubic's damage is wrong
- [x] Traps
- [x] Decoys
- [x] Trading between players
  - [x] Direct trade
  - [x] Private store
    - [ ] Bulk buying/selling
- [x] Monsters
  - [x] Can use skills (okay-ish)
  - [x] On kill rewards
    - [x] Item drops
    - [x] Experience / skill points
    - [x] Spoil
  - [x] Monster family group aggro
  - [x] Raid bosses
    - [x] Raid boss points
  - [x] Epic bosses (general support)
    - [x] Core
    - [x] Orfen
    - [x] Antharas
    - [x] Valakas
    - [x] Beleth
    - [x] Frintezza
    - [x] Freya
    - [x] Zaken
    - [x] Queen Ant
  - [ ] Treasure chests
  - [x] Feedable monsters
- [x] Walking and talking NPCs
- [x] Parties
  - [x] Rewards distribution
  - [x] Inviting, kicking out, changing leader, exiting
  - [ ] Command channel
  - [ ] Party finder (needs more testing)
- [x] Clans
  - [x] Creation
  - [x] Inviting new members
  - [x] Assigning titles
  - [x] Crests
  - [x] Increasing clan level
  - [ ] Clan skills
  - [ ] Clan wars
  - [ ] Alliances
- [x] Chat
  - [x] All
  - [x] Trade
  - [x] Shout
  - [x] Party
  - [x] Clan
  - [x] Alliance
  - [x] Hero
  - [x] Party match room
  - [x] Whisper
  - [x] Battlefield
  - [x] Linking items in chat window
- [x] Macros
- [ ] Manor system
  - [x] Preliminary support
  - [ ] Harvesting (untested)
  - [ ] Selling crops (untested)
- [x] Quest system
  - [x] First class change
  - [x] Second class change
  - [x] Third class change
  - [x] Low level quests
  - [x] Transformation quest
  - [x] All other quests
- [x] Boats
- [x] Airship Gludio-Gracia
- [x] Friend list
  - [x] Friend chat
- [x] Block list (needs testing)
- [x] Seven signs
  - [x] Registration
  - [x] Contributing seal stones
    - [x] Ancient adena reward based on contribution
  - [x] Festival of darkness
  - [x] Result tallying
  - [x] Orator of revelations and Preacher of darkness
  - [x] Dimensional Rift (more testing needed)
- [x] Zones (peace zone, pvp zone...)
- [x] Geodata
- [x] Pathfinding
  - [x] Using geodata
  - [ ] Using path node files
- [x] NPC merchants
  - [x] Buy/sell items
  - [x] Multisell (like Giran luxury shop)
  - [x] Buying back items previously sold
- [x] Skill trainers
- [x] Dyes
- [ ] Monster race
  - [x] The race itself
  - [ ] Betting
- [x] Warehouse
  - [x] Private
  - [x] Clan
  - [ ] Sorted
- [x] Gatekeepers
  - [x] Low level player discount
  - [ ] Weekend discount (untested)
  - [x] Town-in-siege checking
- [ ] Lottery
- [ ] Clan halls
  - [ ] Auction (needs testing)
  - [x] Services (buffs, hp/mp/cp regen...)
  - [ ] Siegable halls (preliminary support, untested)
- [x] Castles
- [ ] Fortresses (preliminary support, untested)
- [ ] Territory War (preliminary support, untested)
- [x] Instances
- [x] Subclasses
  - [x] Subclass quests
  - [x] Subclass skills (skills learned on main class depending on subclass)
  - [ ] Buffs restored on subclass change
  - [x] Kamael bonus subclass Judicator
- [x] Fishing
  - [x] Monsters that appear while fishing
  - [x] Skills learnt with fishing rewards
  - [x] Fishing shots quest
- [x] Admin commands
- [x] User commands
- [x] Four Sepulchers (untested)
- [x] Duels
  - [ ] Party duels (untested)
- [x] Mail system
  - [x] Attachments
- [x] Punishment manager (untested)
- [x] Cursed weapons
- [x] Olympiad (untested)
- [x] Day/night monsters in Forest of the Dead
- [x] Community Board
  - [x] Clan notice on login
- [x] Fantasy Island
- [x] Server shutdown/restart
